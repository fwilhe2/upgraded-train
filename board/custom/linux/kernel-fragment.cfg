# Kernel config fragment for Buildroot (save as linux/kernel-cgroup-overlay.cfg)
# Enables core namespaces, cgroups, overlayfs and common networking needed for containers.
#
# Merge this fragment into the kernel .config used by Buildroot.

# Core namespaces
CONFIG_NAMESPACES=y
CONFIG_UTS_NS=y
CONFIG_IPC_NS=y
CONFIG_PID_NS=y
CONFIG_NET_NS=y
CONFIG_USER_NS=y

# Control groups (cgroups)
CONFIG_CGROUPS=y
CONFIG_CGROUP_CPUACCT=y
CONFIG_CGROUP_DEVICE=y
CONFIG_CPUSETS=y
CONFIG_CGROUP_SCHED=y
CONFIG_MEMCG=y
CONFIG_CGROUP_FREEZER=y
CONFIG_CGROUP_PIDS=y

# Enable swap account if you want memory controller accounting (optional)
# CONFIG_MEMCG_SWAP=y

# Overlay filesystem
CONFIG_OVERLAY_FS=y

# Common filesystems
CONFIG_EXT4_FS=y
CONFIG_TMPFS=y
CONFIG_TMPFS_XATTR=y

# Networking and bridging for container networking
CONFIG_BRIDGE=y
CONFIG_BRIDGE_NETFILTER=y
CONFIG_NF_CONNTRACK=y
CONFIG_NF_TABLES=y
CONFIG_NF_TABLES_INET=y
CONFIG_NF_NAT=y
CONFIG_NETFILTER_XT_MATCH_ADDRTYPE=y

# Device mapper if needed by some images (optional)
CONFIG_BLK_DEV_DM=y

# Keys (helps with some user namespace secure operations)
CONFIG_KEYS=y

# Recommended for filesystem overlay performance and device handling
# (other virtualization options left commented â€” enable if desired)
# CONFIG_KVM=y
# CONFIG_VFIO=y

# End kernel fragment